<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Creating RegionGrids · GeoRegions.jl</title><meta name="title" content="Creating RegionGrids · GeoRegions.jl"/><meta property="og:title" content="Creating RegionGrids · GeoRegions.jl"/><meta property="twitter:title" content="Creating RegionGrids · GeoRegions.jl"/><meta name="description" content="Documentation for GeoRegions.jl."/><meta property="og:description" content="Documentation for GeoRegions.jl."/><meta property="twitter:description" content="Documentation for GeoRegions.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="GeoRegions.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">GeoRegions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">What is a GeoRegion: An Overview</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../georegions/intro.html">What is a GeoRegion?</a></li><li><a class="tocitem" href="../georegions/create.html">Creating GeoRegions</a></li><li><a class="tocitem" href="../georegions/predefined.html">Predefined GeoRegions</a></li><li><a class="tocitem" href="../georegions/read.html">Retrieving GeoRegions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">What is a RegionGrid: An Overview</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="intro.html">What is a RegionGrid?</a></li><li class="is-active"><a class="tocitem" href="create.html">Creating RegionGrids</a><ul class="internal"><li><a class="tocitem" href="#RectGrid-Example"><span><code>RectGrid</code> Example</span></a></li><li><a class="tocitem" href="#PolyGrid-Example"><span><code>PolyGrid</code> Example</span></a></li><li><a class="tocitem" href="#The-Mask-of-a-PolyGrid"><span>The Mask of a <code>PolyGrid</code></span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Using GeoRegions.jl: A Tutorial</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../using/isin.html">Is it in a GeoRegion?</a></li><li><a class="tocitem" href="../using/custom.html">Custom GeoRegions</a></li><li><a class="tocitem" href="../using/extract.html">Data Extraction via RegionGrids</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">LandSea Datasets: ETOPO 2022</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../landsea/intro.html">What is a LandSea Dataset?</a></li><li><a class="tocitem" href="../landsea/create.html">Loading LandSea Datasets</a></li><li><a class="tocitem" href="../landsea/smooth.html">Smoothing LandSea Masks</a></li></ul></li><li><a class="tocitem" href="../example/placeholder.html">Examples</a></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Lists of GeoRegions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../lists/api.html">API</a></li><li><a class="tocitem" href="../lists/default.html">Default</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">What is a RegionGrid: An Overview</a></li><li class="is-active"><a href="create.html">Creating RegionGrids</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="create.html">Creating RegionGrids</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaClimate/GeoRegions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaClimate/GeoRegions.jl/blob/main/docs/src/regiongrids/create.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="RegionGrid:-Applying-GeoRegions-to-Gridded-Data"><a class="docs-heading-anchor" href="#RegionGrid:-Applying-GeoRegions-to-Gridded-Data">RegionGrid: Applying GeoRegions to Gridded Data</a><a id="RegionGrid:-Applying-GeoRegions-to-Gridded-Data-1"></a><a class="docs-heading-anchor-permalink" href="#RegionGrid:-Applying-GeoRegions-to-Gridded-Data" title="Permalink"></a></h1><p>In this section, we go through the basic steps of creating a RegionGrid for <code>RectRegion</code>s and <code>PolyRegion</code>s.  See if you can spot the differences between the RegionGrids generated by the two different types.</p><h3 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h3><pre><code class="language-julia hljs">using GeoRegions
using DelimitedFiles
using CairoMakie

download(&quot;https://raw.githubusercontent.com/natgeo-wong/GeoPlottingData/main/coastline_resl.txt&quot;,&quot;coast.cst&quot;)
coast = readdlm(&quot;coast.cst&quot;,comments=true)
clon  = coast[:,1]
clat  = coast[:,2]
nothing</code></pre><h2 id="RectGrid-Example"><a class="docs-heading-anchor" href="#RectGrid-Example"><code>RectGrid</code> Example</a><a id="RectGrid-Example-1"></a><a class="docs-heading-anchor-permalink" href="#RectGrid-Example" title="Permalink"></a></h2><pre><code class="language-julia hljs">geo  = GeoRegion(&quot;GF_SSA&quot;)
lon  = -180:5:180
lat  = -90:5:90
ggrd = RegionGrid(geo,lon[1:(end-1)],lat)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">The Rectilinear Grid has the following properties:
    Grid Bounds       (grid) : [15, 7, 29, 21]
    Longitude Indices (ilon) : [21, 22, 23, 24, 25, 26, 27, 28, 29]
    Latitude Indices  (ilat) : [7, 8, 9, 10, 11, 12, 13, 14, 15]
    Longitude Points   (lon) : [280, 285, 290, 295, 300, 305, 310, 315, 320]
    Latitude Points    (lat) : [-60, -55, -50, -45, -40, -35, -30, -25, -20]
    Region Size (nlon * nlat) : 9 lon points x 9 lat points
</code></pre><h2 id="PolyGrid-Example"><a class="docs-heading-anchor" href="#PolyGrid-Example"><code>PolyGrid</code> Example</a><a id="PolyGrid-Example-1"></a><a class="docs-heading-anchor-permalink" href="#PolyGrid-Example" title="Permalink"></a></h2><pre><code class="language-julia hljs">geo  = GeoRegion(&quot;AR6_NWS&quot;)
lon  = -180:2:180;
lat  = -90:2:90;
ggrd = RegionGrid(geo,lon[1:(end-1)],lat)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">The Polygonal Grid has the following properties:
    Grid Bounds       (grid) : [52, 39, 55, 50]
    Longitude Indices (ilon) : [50, 51, 52, 53, 54, 55]
    Latitude Indices  (ilat) : [39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
    Longitude Points   (lon) : [-82.0, -80.0, -78.0, -76.0, -74.0, -72.0]
    Latitude Points    (lat) : [-14.0, -12.0, -10.0, -8.0, -6.0, -4.0, -2.0, 0.0, 2.0, 4.0, 6.0, 8.0, 10.0, 12.0]
    Region Size (nlon * nlat) : 6 lon points x 14 lat points
    Region Mask (sum(mask) / (nlon * nlat)) : 70 / 84
</code></pre><p>So here, we see that in this <code>PolyGrid</code> example, the <code>RegionGrid</code> contains an additional field <code>mask</code> that, within the rectilinear longitude-latitude shape bounding the <code>GeoRegion</code> (because gridded data here is assumed to be rectilinear), the data is within the GeoRegion.  Values of <code>1</code> indicate it is within the GeoRegion, otherwise the values are `NaN.</p><pre><code class="language-julia hljs">ggrd.mask</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6×14 Matrix{Float64}:
 NaN    NaN    1.0  1.0  1.0  1.0  1.0  …  NaN    NaN    NaN    NaN    NaN
 NaN      1.0  1.0  1.0  1.0  1.0  1.0       1.0    1.0  NaN    NaN    NaN
   1.0    1.0  1.0  1.0  1.0  1.0  1.0       1.0    1.0    1.0  NaN    NaN
   1.0    1.0  1.0  1.0  1.0  1.0  1.0       1.0    1.0    1.0    1.0  NaN
   1.0    1.0  1.0  1.0  1.0  1.0  1.0       1.0    1.0    1.0    1.0    1.0
   1.0    1.0  1.0  1.0  1.0  1.0  1.0  …    1.0    1.0    1.0    1.0    1.0</code></pre><h2 id="The-Mask-of-a-PolyGrid"><a class="docs-heading-anchor" href="#The-Mask-of-a-PolyGrid">The Mask of a <code>PolyGrid</code></a><a id="The-Mask-of-a-PolyGrid-1"></a><a class="docs-heading-anchor-permalink" href="#The-Mask-of-a-PolyGrid" title="Permalink"></a></h2><p>The <code>PolyGrid</code> type derived from a <code>PolyRegion</code> allows us to apply a mask to filter out data that is within the <code>shape</code> of a <code>PolyRegion</code> on a rectilinear lon-lat grid defined by the <code>bound</code> of a PolyRegion.  We consider the following example of an AR6 region over South Asia:</p><pre><code class="language-julia hljs">geo  = GeoRegion(&quot;AR6_SAS&quot;)
lon  = -180:5:180;
lat  = -90:2:90;
ggrd = RegionGrid(geo,lon[1:(end-1)],lat)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">The Polygonal Grid has the following properties:
    Grid Bounds       (grid) : [61, 50, 57, 49]
    Longitude Indices (ilon) : [49, 50, 51, 52, 53, 54, 55, 56, 57]
    Latitude Indices  (ilat) : [50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61]
    Longitude Points   (lon) : [60.0, 65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0]
    Latitude Points    (lat) : [8.0, 10.0, 12.0, 14.0, 16.0, 18.0, 20.0, 22.0, 24.0, 26.0, 28.0, 30.0]
    Region Size (nlon * nlat) : 9 lon points x 12 lat points
    Region Mask (sum(mask) / (nlon * nlat)) : 55 / 108
</code></pre><p>And using the field mask, we plot the points that are in the region (blue), and out of the region (red).</p><pre><code class="language-julia hljs">mask = ggrd.mask
grid = ones(size(mask))
inlon = grid .* ggrd.lon;  inlon = inlon[.!isnan.(mask)]
inlat = grid .* ggrd.lat&#39;; inlat = inlat[.!isnan.(mask)]
otlon = grid .* ggrd.lon;  otlon = otlon[isnan.(mask)]
otlat = grid .* ggrd.lat&#39;; otlat = otlat[isnan.(mask)]
blon,blat,slon,slat = coordGeoRegion(geo)

fig = Figure()
aspect = (maximum(slon)-minimum(slon))/(maximum(slat)-minimum(slat))
ax = Axis(
    fig[1,1],width=750,height=750/aspect,
    limits=(minimum(slon)-2,maximum(slon)+2,minimum(slat)-2,maximum(slat)+2)
)

lines!(ax,clon,clat,color=:black)
lines!(ax,blon,blat)
lines!(ax,slon,slat)
scatter!(ax,otlon,otlat)
scatter!(ax,inlon,inlat)

resize_to_layout!(fig)
fig</code></pre><img src="create-dbb0e37f.svg" alt="Example block output"/><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoRegions.RegionGrid-Tuple{RectRegion, Vector{&lt;:Real}, Vector{&lt;:Real}}" href="#GeoRegions.RegionGrid-Tuple{RectRegion, Vector{&lt;:Real}, Vector{&lt;:Real}}"><code>GeoRegions.RegionGrid</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RegionGrid(
    geo :: GeoRegion,
    lon :: Union{Vector{&lt;:Real},AbstractRange{&lt;:Real},
    lat :: Union{Vector{&lt;:Real},AbstractRange{&lt;:Real}
) -&gt; RectGrid, PolyGrid</code></pre><p>Creates a <code>RectGrid</code> or <code>PolyGrid</code> type based on the following arguments. This method is suitable for rectilinear grids of longitude/latitude output such as from Isca, or from satellite and reanalysis gridded datasets.</p><p><strong>Arguments</strong></p><ul><li><code>geo</code> : A GeoRegion of interest</li><li><code>lon</code> : A vector or <code>AbstractRange</code> containing the longitude points</li><li><code>lat</code> : A vector or <code>AbstractRange</code> containing the latitude points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaClimate/GeoRegions.jl/blob/19dfd82177d2b5032e082e323b12baa286ea82e4/src/extract/extract.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoRegions.RegionGrid-Tuple{GeoRegion, Matrix{&lt;:Real}, Matrix{&lt;:Real}}" href="#GeoRegions.RegionGrid-Tuple{GeoRegion, Matrix{&lt;:Real}, Matrix{&lt;:Real}}"><code>GeoRegions.RegionGrid</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RegionGrid(
    geo :: GeoRegion,
    lon :: Array{&lt;:Real,2},
    lat :: Array{&lt;:Real,2}
) -&gt; RegionGrid</code></pre><p>Creates a <code>RegionMask</code> type based on the following arguments. This method is more suitable for non-rectilinear grids of longitude and latitude points, such as in the output of WRF or CESM.</p><p><strong>Arguments</strong></p><ul><li><code>geo</code> : A GeoRegion of interest</li><li><code>lon</code> : An array containing the longitude points</li><li><code>lat</code> : An array containing the latitude points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaClimate/GeoRegions.jl/blob/19dfd82177d2b5032e082e323b12baa286ea82e4/src/extract/extract.jl#L31-L46">source</a></section></article><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="intro.html">« What is a RegionGrid?</a><a class="docs-footer-nextpage" href="../using/isin.html">Is it in a GeoRegion? »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 12 January 2024 00:15">Friday 12 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
